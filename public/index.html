<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Survive.io</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/nipplejs/0.10.1/nipplejs.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background: #050505; font-family: 'Segoe UI', Roboto, sans-serif; touch-action: none; color: white; }
        canvas { display: block; }
        
        #menu-overlay, #death-overlay, #global-modal { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.85); backdrop-filter: blur(10px);
            display: flex; align-items: center; justify-content: center; z-index: 100;
        }
        
        .box { 
            background: rgba(40, 40, 40, 0.5); padding: 40px; border-radius: 24px; 
            text-align: center; border: 1px solid rgba(255,255,255,0.1); width: 90%; max-width: 400px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.6); animation: fadeIn 0.4s ease-out;
        }

        @keyframes fadeIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }

        h1 { font-size: 42px; font-weight: 900; color: #4CAF50; margin-bottom: 25px; }
        input { padding: 15px; width: 85%; border-radius: 12px; border: 1px solid #444; font-size: 18px; margin-bottom: 20px; text-align: center; background: rgba(0,0,0,0.5); color: white; outline: none; }
        button { padding: 14px 28px; font-size: 18px; cursor: pointer; background: #4CAF50; color: white; border: none; border-radius: 12px; font-weight: bold; margin: 8px; transition: 0.2s; }
        
        #ping-display { position: fixed; top: 15px; left: 15px; font-size: 14px; font-weight: bold; color: #00ff00; z-index: 90; text-shadow: 1px 1px 2px black; }
        
        #boost-container { 
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%); 
            width: 180px; height: 8px; background: rgba(255,255,255,0.1); 
            border-radius: 10px; z-index: 90; border: 1px solid rgba(255,255,255,0.2); 
            display: none; overflow: hidden;
        }
        #boost-bar { width: 0%; height: 100%; background: #fff; }

        #leaderboard { position: fixed; top: 15px; right: 15px; background: rgba(0,0,0,0.5); padding: 12px; border-radius: 12px; width: 140px; font-size: 13px; z-index: 10; border: 1px solid rgba(255,255,255,0.1); }
        .lb-item { display: flex; justify-content: space-between; margin-bottom: 4px; align-items: center; }
        .lb-item span:first-child { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 90px; display: inline-block; }
        .lb-own { color: #ffeb3b; font-weight: bold; border-top: 1px solid rgba(255,255,255,0.2); margin-top: 5px; padding-top: 5px; }

        #minimap { position: fixed; bottom: 15px; right: 15px; width: 130px; height: 130px; background: rgba(0,0,0,0.4); border: 1px solid rgba(255,255,255,0.2); border-radius: 12px; z-index: 10; }

        .btn-mob { 
            position: fixed; width: 65px; height: 65px; background: rgba(255,255,255,0.1); 
            border: 2px solid rgba(255,255,255,0.4); border-radius: 50%; z-index: 95; 
            display: none; align-items: center; justify-content: center; font-weight: bold; 
            font-size: 12px; color: white; backdrop-filter: blur(5px);
        }
        #btn-boost-mob { bottom: 35px; right: 165px; border-color: #ffeb3b; }
        #btn-eject-mob { bottom: 115px; right: 165px; border-color: #4CAF50; }

        #orientation-warning { 
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: #000; z-index: 999; flex-direction: column; align-items: center; 
            justify-content: center; text-align: center; color: white; 
        }

        #joystick-zone { position: fixed; bottom: 30px; left: 30px; width: 120px; height: 120px; z-index: 50; display: none; }
    </style>
</head>
<body oncontextmenu="return false;">
    <div id="orientation-warning"><h2>Lütfen Cihazı Yatay Döndürün</h2></div>
    <div id="ping-display">Ping: -- ms</div>
    <div id="boost-container"><div id="boost-bar"></div></div>
    
    <div id="menu-overlay">
        <div class="box">
            <h1>Survive.io</h1>
            <input type="text" id="username" placeholder="İsminiz..." maxlength="10">
            <div style="margin-bottom:15px;">Kontrol: 
                <select id="control-type" style="padding:4px; background:#333; color:white; border:none;">
                    <option value="auto">Otomatik</option><option value="mouse">Mouse</option><option value="joystick">Joystick</option>
                </select>
            </div>
            <button id="btn-play" style="width:100%">OYNA</button>
            <button onclick="document.getElementById('global-modal').style.display='flex'" style="background:#ff9800; width:100%; margin-top:8px;">REKORLAR</button>
        </div>
    </div>

    <div id="death-overlay" style="display:none;">
        <div class="box">
            <h1 style="color:#ff4444">ÖLDÜN!</h1>
            <div id="final-score" style="font-size:24px; margin:20px 0;">Skor: 0</div>
            <button onclick="location.reload()" style="width:100%">TEKRAR DENE</button>
        </div>
    </div>

    <div id="global-modal" style="display:none;">
        <div class="box">
            <h3>GLOBAL REKORLAR</h3>
            <div id="global-list" style="text-align:left; max-height:200px; overflow-y:auto; font-size:14px; margin:15px 0;"></div>
            <button onclick="document.getElementById('global-modal').style.display='none'" style="background:#555; width:100%">KAPAT</button>
        </div>
    </div>

    <div id="leaderboard" style="display:none;"><div id="lb-list"></div><div id="lb-player" class="lb-own"></div></div>
    <div id="minimap" style="display:none;"><canvas id="minimap-canvas" width="130" height="130"></canvas></div>
    
    <div id="joystick-zone"></div>
    <div id="btn-boost-mob" class="btn-mob">BOOST</div>
    <div id="btn-eject-mob" class="btn-mob">AT</div>
    
    <canvas id="gameCanvas"></canvas>
    
    <!-- SES DOSYALARI -->
    <audio id="sfx-eat" src="https://actions.google.com/sounds/v1/foley/crumb_eat.ogg" preload="auto"></audio>
    <audio id="sfx-boost" src="https://actions.google.com/sounds/v1/foley/whoosh.ogg" preload="auto"></audio>
    <audio id="sfx-virus" src="https://actions.google.com/sounds/v1/impacts/crash_metal.ogg" preload="auto"></audio>
    <audio id="sfx-eject" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg" preload="auto"></audio>

    <script src="/socket.io/socket.io.js"></script>
    <script src="game.js"></script>
</body>
</html>
